{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="card" style="max-width:560px;margin:24px auto;">
  <h2>Editar entrada</h2>
  <form method="post" action="{% url 'edit_password' entry.id %}" class="grid">
    {% csrf_token %}
    <div class="field">
      <label>Nombre del sitio</label>
      <input type="text" name="site_name" value="{{ entry.site_name }}" placeholder="Nombre del sitio" required>
    </div>
    <div class="field">
      <label>URL del sitio</label>
      <input type="url" name="site_url" value="{{ entry.site_url }}" placeholder="https://..." required>
    </div>
    <div class="field">
      <label>Usuario</label>
      <input type="text" name="username" value="{{ entry.username }}" placeholder="Usuario" required>
    </div>
    <div class="field">
      <label>Categoría</label>
      <select name="category" style="width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid #374151; background: #0b1220; color: var(--text);">
        <option value="other" {% if entry.category == 'other' %}selected{% endif %}>Otro</option>
        <option value="work" {% if entry.category == 'work' %}selected{% endif %}>Trabajo</option>
        <option value="personal" {% if entry.category == 'personal' %}selected{% endif %}>Personal</option>
        <option value="social" {% if entry.category == 'social' %}selected{% endif %}>Redes Sociales</option>
        <option value="finance" {% if entry.category == 'finance' %}selected{% endif %}>Finanzas</option>
        <option value="shopping" {% if entry.category == 'shopping' %}selected{% endif %}>Compras</option>
        <option value="entertainment" {% if entry.category == 'entertainment' %}selected{% endif %}>Entretenimiento</option>
        <option value="education" {% if entry.category == 'education' %}selected{% endif %}>Educación</option>
      </select>
    </div>
    <div class="field">
      <label>Nueva contraseña (dejar en blanco para no cambiar)</label>
      <div style="display:flex; gap:8px;">
        <input id="edit-password" type="password" name="password" placeholder="Nueva contraseña" style="flex:1;">
        <button id="toggle-edit-pass" type="button" class="btn">Mostrar</button>
        <button id="generate-edit-password" type="button" class="btn" title="Generar contraseña segura">
          <i class="fas fa-key"></i>
        </button>
      </div>
      <div style="margin-top:8px; display:grid; gap:6px;">
        <meter id="edit-meter" min="0" max="5" low="2" high="4" optimum="5" value="0"></meter>
        <small id="edit-label" class="muted">Fortaleza: Muy débil</small>
      </div>
    </div>
    <div class="field">
      <label>Notas (opcional)</label>
      <textarea name="notes" placeholder="Información adicional sobre esta contraseña..." rows="3" style="width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid #374151; background: #0b1220; color: var(--text); resize: vertical;">{{ entry.notes|default:'' }}</textarea>
    </div>
    <div>
      <button type="submit" class="btn primary">Guardar cambios</button>
      <a class="btn" href="{% url 'dashboard' %}">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}

<script type="module">
import { attachPasswordStrengthMeter, attachPasswordToggle, preventDoubleSubmit, attachPasswordGenerator } from '/static/js/app.js';
attachPasswordStrengthMeter('#edit-password', '#edit-meter', '#edit-label');
attachPasswordToggle('#toggle-edit-pass', '#edit-password');
attachPasswordGenerator('#generate-edit-password', '#edit-password', { length: 16 });
preventDoubleSubmit('form');
</script>


